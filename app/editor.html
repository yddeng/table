<!doctype html>
<html>
<head>
	<meta charset='utf-8'>
	<title> ExcelEditor</title>
	<script data-jsfiddle="common" src="./jquery.min.js"></script>
	<script src="./handsontable.full.js"></script>
	<script src="./websocket.js"></script>
	<script src="./message.js"></script>
	<script src="./handsontable.js"></script>
	<link rel="stylesheet" media="screen" href="./css/handsontable.full.css">
</head>
<body>
<div id="table" style="width: 100px;height: 500px"></div>
<script>

	console.log(getUrlParam("userName"));
	/*socket.connect("ws://127.0.0.1:4545/table",function(){
		console.log("connect ok");
		socket.send({cmd:'openFile',fileName:"test.xlsx",userName:"deng"});
	});*/

	var container = document.getElementById('table');
	var hot = handstable.init(container)

	function getUrlParam(name) {
		let reg = new RegExp('(^|&)'+ name + '=([^&]*)(&|$)')
		let r = window.location.search.substr(1).match(reg)
		if(r!=null){
			return unescape(r[2])
		}
		return null
	}

</script>
</body>
</html>