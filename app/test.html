<!doctype html>
<html>
<head>
    <meta charset='utf-8'>
    <title> ExcelEditor</title>
    <script src="dist/jquery.min.js"></script>
    <script src="dist/handsontable.full.js"></script>
    <script src="dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" media="screen" href="./css/handsontable.full.css">
    <style>
        body{
            margin: 0 auto;
        }
    </style>
</head>
<body>
<div id="table"></div>
<script>
    let container = document.getElementById('table')
 let hot =  new Handsontable(container, {
        data: [["1","2","3","4","5","6"]],
        readOnly:false,
        width:'100%',
        height:window.innerHeight - 100,
        minCols:26, //最小列数
        //maxCols: 50, //最大列数
        minRows:50 , //最小行数
        //maxRows: 40 , //最大行数
        minSpareCols: 10, //添加空列
        minSpareRows :10,//添加空行
        colHeaders:true, //显示列表头， 默认false， 可取 true/fals/数组 ，当值为数组时，列头为数组的值
        rowHeaders:true,　//显示行表头， 默认 false， 可取 true/fals/数组，当值为数组时，行头为数组的值
        mergeCells: false, //表示允许单元格合并
        fixedRowsTop : 3,    //冻结行（固定顶部开始算起指定行不随垂直滚动条滚动；
        fixedColumnsLeft : 0, //冻结列（固定右边开始算起指定行不随水平滚动条滚动）；
        manualColumnFreeze:true,  //设置true后在单元格中右击出现一个菜单，此菜单会多出一个“Unfteeze this columu”的选项，再次点击就会取消冻结动作。 默认为false
        manualColumnResize: false, //允许拖曳列表头，默认为false
        manualRowResize: false, //允许拖曳行表头，默认为false
        manualColumnMove: false, //true/false 当值为true时，列可拖拽移动到指定列
        manualRowMove: false, //true/false当值为true时，行可拖拽至指定行
        //currentRowClassName:"curRow", //给当前行设置样式名（鼠标点击某个单元格，则整行给样式）
        //currentColClassName:"cur", //给当前行列设置样式名（鼠标点击某个单元格，则整行给样式）
        autoColumnSize: true, //当值为true且列宽未设置时，自适应列大小
        //columnWidth:108,
        //columnSorting:true, //通过点击列表头进行排序（没有图标）
        //colWidths:[10,5,50],
        //rowHeights: [50, 40, 100],
        stretchH:"all", // 可取 last/all/none last：延伸最后一列，all：延伸所有列，none默认不延伸。
        //undo: true,
        //redo: true,
        //language:Handsontable.language.registerLanguageDictionary(zhCh),
        contextMenu:true, //显示表头的下拉菜单默认false 可取 true/false/自定义数组
        contextMenu: {    //内容部分的menu 对功能汉化
            callback: function (key, selection, clickEvent) {
                //console.log(key, selection, clickEvent);
            },
            items: {
                'freeze_column':{
                    name: '冻结该列'
                },
                'unfreeze_column':{
                    name:'取消冻结'
                },
                'row_above': {
                    name: '上面插入一行',
                    callback: function () {
                        let idx = this.getSelectedLast()[0];
                        insertRow(idx)
                    }
                },
                'row_below': {
                    name: '下面插入一行',
                    callback: function () {
                        let idx = this.getSelectedLast()[0]+1;
                        insertRow(idx)
                    }
                },
                'col_left':{
                    name: '左侧插入一列',
                    callback: function () {
                        let idx = this.getSelectedLast()[1];
                        insertCol(idx)
                    }
                },
                'col_right':{
                    name: '右侧插入一列',
                    callback: function () {
                        let idx = this.getSelectedLast()[1]+1;
                        insertCol(idx)
                    }
                },
                '---------':{},
                'remove_row':{
                    name: '移除本行',
                    callback: function () {
                        let idx = this.getSelectedLast()[0];
                        removeRow(idx)
                    }
                },
                'remove_col':{
                    name: '移除本列',
                    callback: function () {
                        let idx = this.getSelectedLast()[1];
                        removeCol(idx)
                    }
                },
                'separator': Handsontable.plugins.ContextMenu.SEPARATOR,
                'clear_custom': {
                    name: '清空所有单元格数据',
                    callback: function () {
                        this.clear()
                    }
                }
            }
        },
        afterChange:function(changes,source){
            console.log("afterChange",changes,source)
            //console.log(this.getData())
        },
        afterSelectionEnd: function(row, col, row2, col2) {
            console.log("afterSelectionEnd",row,col,row2,col2)
            console.log(this.hasHook("afterChange"))
            this.removeHook("afterChange",function () {
                console.log("removeHook")
            });
            console.log(this.hasHook("afterChange"))
            this.setDataAtCell(row,col,"6")
            //console.log("getCellEditor",this.getCellEditor(row,col))
            this.readOnlyCellClassName = true;
            this.render();
        },
    });

</script>
</body>
</html>